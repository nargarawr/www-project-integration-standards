doctype: CRE
id: 365-239
links:
- document:
    description: Verify that there is an explicit policy for management of cryptographic
      keys and that a cryptographic key lifecycle follows a key management standard
      such as NIST SP 800-57.
    doctype: CRE
    id: 002-014-008
    name: ENCRYPT_DATA_AT_REST_KEY/SECRET_MANAGEMENT_LIFECYCLE
  type: SAM
- document:
    description: Verify that consumers of cryptographic services protect key material
      and other secrets by using key vaults or API based alternatives.
    doctype: CRE
    id: 002-005-051
    name: ENCRYPT_DATA_AT_REST_KEY/SECRET_MANAGEMENT_VAULT
  type: SAM
- document:
    description: Verify that all keys and passwords are replaceable and are part of
      a well-defined process to re-encrypt sensitive data.
    doctype: CRE
    id: 002-014-007
    name: ENCRYPT_DATA_AT_REST_KEY/SECRET_MANAGEMENT
  type: SAM
- document:
    description: Verify the application encrypts communications between components,
      particularly when these components are in different containers, systems, sites,
      or cloud providers. (C3)
    doctype: CRE
    id: 002-026-057
    name: PROTECT_DATA_IN_TRANSIT_BETWEEN_COMPONENTS
  type: SAM
- document:
    description: Verify that application components verify the authenticity of each
      side in a communication link to prevent person-in-the-middle attacks. For example,
      application components should validate TLS certificates and chains.
    doctype: CRE
    id: 012-030-024
    name: PROTECT_DATA_IN_TRANSIT_VERIFY_TLS_AUTHENTICITY
  type: SAM
- document:
    description: Verify that regulated private data is stored encrypted while at rest,
      such as personally identifiable information (PII), sensitive personal information,
      or data assessed likely to be subject to EU's GDPR.
    doctype: CRE
    id: 005-021-063
    name: ENCRYPT_SENSITIVE_DATA_AT_REST
  type: SAM
- document:
    description: Verify that all cryptographic modules fail securely, and errors are
      handled in a way that does not enable Padding Oracle attacks.
    doctype: CRE
    id: 005-021-031
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_MODULES_FAIL_SECURELY
  type: SAM
- document:
    description: Verify that industry proven or government approved cryptographic
      algorithms, modes, and libraries are used, instead of custom coded cryptography.
      (C8)
    doctype: CRE
    id: 005-021-049
    name: ENCRYPT_DATA_CRYPTOGRAPHIC_DIRECTIVES
  type: SAM
- document:
    description: Verify that encryption initialization vector, cipher configuration,
      and block modes are configured securely using the latest advice.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_SECURE_CONFIGURATION
  type: SAM
- document:
    description: Verify that random number, encryption or hashing algorithms, key
      lengths, rounds, ciphers or modes, can be reconfigured, upgraded, or swapped
      at any time, to protect against cryptographic breaks. (C8)
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_REPLACEABLE_CRYPTOGRAPHY
  type: SAM
- document:
    description: Verify that known insecure block modes (i.e. ECB, etc.), padding
      modes (i.e. PKCS#1 v1.5, etc.), ciphers with small block sizes (i.e. Triple-DES,
      Blowfish, etc.), and weak hashing algorithms (i.e. MD5, SHA1, etc.) are not
      used unless required for backwards compatibility.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_ONLY_SECURE_MODES
  type: SAM
- document:
    description: Verify that nonces, initialization vectors, and other single use
      numbers must not be used more than once with a given encryption key. The method
      of generation must be appropriate for the algorithm being used.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_NONCE_IV
  type: SAM
- document:
    description: Verify that encrypted data is authenticated via signatures, authenticated
      cipher modes, or HMAC to ensure that ciphertext is not altered by an unauthorized
      party.
    doctype: CRE
    id: 005-021-063
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_AUTHENTICATE
  type: SAM
- document:
    description: Verify that all cryptographic operations are constant-time, with
      no 'short-circuit' operations in comparisons, calculations, or returns, to avoid
      leaking information.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_CONSTANT_TIME_OPERATIONS
  type: SAM
- document:
    description: Verify that all random numbers, random file names, random GUIDs,
      and random strings are generated using the cryptographic module's approved cryptographically
      secure random number generator when these random values are intended to be not
      guessable by an attacker.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_RNG
  type: SAM
- document:
    description: Verify that random GUIDs are created using the GUID v4 algorithm,
      and a cryptographically-secure pseudo-random number generator (CSPRNG). GUIDs
      created using other pseudo-random number generators may be predictable.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_RNG_GUID
  type: SAM
- document:
    description: Verify that random numbers are created with proper entropy even when
      the application is under heavy load, or that the application degrades gracefully
      in such circumstances.
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES_RNG_GRACEFUL_DEGRADATION
  type: SAM
- document:
    description: Verify the application protects sensitive data from being cached
      in server components such as load balancers and application caches.
    doctype: CRE
    id: 005-038-029
    name: DATA_PROTECTION_SENSITIVE_NO_CACHING_SERVERSIDE
  type: SAM
- document:
    description: Verify that all cached or temporary copies of sensitive data stored
      on the server are protected from unauthorized access or purged/invalidated after
      the authorized user accesses the sensitive data.
    doctype: CRE
    id: 005-038-016
    name: DATA_PROTECTION_SENSITIVE_AUTHORIZE_AND_PURGE_TEMPORARY_DATA
  type: SAM
- document:
    description: Verify the application minimizes the number of parameters in a request,
      such as hidden fields, Ajax variables, cookies and header values.
    doctype: CRE
    id: 005-029
    name: DATA_PROTECTION_MINIMIZE_REQUEST_PARAMETERS
  type: SAM
- document:
    description: Verify that regular backups of important data are performed and that
      test restoration of data is performed.
    doctype: CRE
    id: 005-032-071
    name: ENCRYPT_DATA_AT_REST_BACKUP_REGULARLY
  type: SAM
- document:
    description: Verify that backups are stored securely to prevent data from being
      stolen or corrupted.
    doctype: CRE
    id: 005-032-053
    name: ENCRYPT_DATA_AT_REST_BACKUP_PROTECTION
  type: SAM
- document:
    description: Verify the application sets sufficient anti-caching headers so that
      sensitive data is not cached in modern browsers.
    doctype: CRE
    id: 005-038-028
    name: DATA_PROTECTION_SENSITIVE_NO_CACHING_CLIENTSIDE_HEADERS
  type: SAM
- document:
    description: Verify that data stored in client side storage (such as HTML5 local
      storage, session storage, IndexedDB, regular cookies or Flash cookies) does
      not contain sensitive data or PII.
    doctype: CRE
    id: 005-038-028
    name: DATA_PROTECTION_SENSITIVE_NO_CACHING_CLIENTSIDE
  type: SAM
- document:
    description: Verify that authenticated data is cleared from client storage, such
      as the browser DOM, after the client or session is terminated.
    doctype: CRE
    id: 005-038-015
    name: DATA_PROTECTION_SENSITIVE_PURGE_CLIENTSIDE
  type: SAM
- document:
    description: Verify that users have a method to remove or export their data on
      demand.
    doctype: CRE
    id: 005-044
    name: DATA_PROTECTION_PII_USER_REMOVAL_FUNCTIONALITY
  type: SAM
- document:
    description: Verify that users are provided clear language regarding collection
      and use of supplied personal information and that users have provided opt-in
      consent for the use of that data before it is used in any way.
    doctype: CRE
    id: 005-044
    name: DATA_PROTECTION_PII_USER_CONSENT
  type: SAM
- document:
    description: Verify that all sensitive data created and processed by the application
      has been identified, and ensure that a policy is in place on how to deal with
      sensitive data. (C8)
    doctype: CRE
    id: 005-044-044
    name: DATA_PROTECTION_IDENTIFY_SENSITIVE_DATA_POLICY
  type: SAM
- document:
    description: Verify accessing sensitive data is audited (without logging the sensitive
      data itself), if the data is collected under relevant data protection directives
      or where logging of access is required.
    doctype: CRE
    id: 005-038-009
    name: DATA_PROTECTION_SENSITIVE_LOG_ACCESS_EVENTS
  type: SAM
- document:
    description: Verify that sensitive information contained in memory is overwritten
      as soon as it is no longer required to mitigate memory dumping attacks, using
      zeroes or random data.
    doctype: CRE
    id: 005-038-054
    name: DATA_PROTECTION_SENSITIVE_PURGE_MEMORY
  type: SAM
- document:
    description: Verify that sensitive or private information that is required to
      be encrypted, is encrypted using approved algorithms that provide both confidentiality
      and integrity. (C8)
    doctype: CRE
    id: 005-021-025
    name: ENCRYPT_DATA_AT_REST_CRYPTOGRAPHIC_DIRECTIVES
  type: SAM
- document:
    description: Verify that sensitive personal information is subject to data retention
      classification, such that old or out of date data is deleted automatically,
      on a schedule, or as the situation requires.
    doctype: CRE
    id: 005-038-054
    name: DATA_PROTECTION_SENSITIVE_CLASSIFY_PURGE
  type: SAM
- document:
    description: Verify that secured TLS is used for all client connectivity, and
      does not fall back to insecure or unencrypted protocols. (C8)
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_TLS_ALL_CONNECTIONS_NO_FALLBACK
  type: SAM
- document:
    description: Verify using online or up to date TLS testing tools that only strong
      algorithms, ciphers, and protocols are enabled, with the strongest algorithms
      and ciphers set as preferred.
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_TLS_DIRECTIVES_NO_FALLBACK
  type: SAM
- document:
    description: Verify that connections to and from the server use trusted TLS certificates.
      Where internally generated or self-signed certificates are used, the server
      must be configured to only trust specific internal CAs and specific self-signed
      certificates. All others should be rejected.
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_TLS_CERTIFICATE_VERIFY
  type: SAM
- document:
    description: Verify that all encrypted connections to external systems that involve
      sensitive information or functions are authenticated.
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_AUTHENTICATE_EXTERNAL_CONNECTIONS
  type: SAM
- document:
    description: Verify that proper certification revocation, such as Online Certificate
      Status Protocol (OCSP) Stapling, is enabled and configured.
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_TLS_CERTIFICATE_REVOCATION
  type: SAM
- document:
    description: Verify that backend TLS connection failures are logged.
    doctype: CRE
    id: 005-022-025
    name: PROTECT_DATA_IN_TRANSIT_TLS_CONNECTION_LOG_FAILURES
  type: SAM
- document:
    description: Verify that sensitive data is sent to the server in the HTTP message
      body or headers, and that query string parameters from any HTTP verb do not
      contain sensitive data.
    doctype: CRE
    id: 004-015-036
    name: PROTECT_DATA_IN_TRANSIT_TLS_HEADERS_PAYLOAD
  type: SAM
name: DATA_PROTECTION
